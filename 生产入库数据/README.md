#  物料入库信息管理与分析系统

## 项目概述

本项目是一套用于物料入库信息管理与分析的工具集，主要功能包括从 Excel 文件导入物料基础信息和入库数据到数据库，以及从数据库提取数据生成月度入库分析透视表，帮助用户高效管理和分析物料入库情况。

## 功能说明

1. **物料信息导入**：从 Excel 读取物料代码和物料描述，经清洗去重后存入数据库`material_info`表
2. **入库数据导入**：从 Excel 读取物料入库时间和入库数量，导入数据库`material_stock`表
3. **入库数据分析**：从数据库关联查询物料信息和入库数据，生成月度入库数据透视表并导出到 Excel

## 环境要求

- Python 3.6+
- 依赖库：
  - `pymysql`（数据库连接）
  - `openpyxl`（Excel 文件处理）
  - `pandas`（数据处理与透视表生成）
  - `numpy`（数值计算）

安装依赖：

bash

```bash
pip install pymysql openpyxl pandas numpy
```

## 使用步骤

1. **准备工作**：

   - 确保 MySQL 数据库已安装并运行
   - 准备包含物料信息和入库数据的 Excel 文件（示例文件路径可在配置中修改）

2. **配置修改**：

   - 在各脚本的配置区修改数据库连接信息（`host`、`user`、`password`、`database`）
   - 修改 Excel 文件路径、工作表名等配置项（根据实际文件位置调整）

3. **执行数据导入**：

   - 首先运行

     ```
     入库物料代码和物料描述.py
     ```

     导入物料基础信息：

     bash

     ```bash
     python 入库物料代码和物料描述.py
     ```

   - 然后运行

     ```
     入库入库时间和入库数量.py
     ```

     导入入库数据：

     bash

     ```bash
     python 入库入库时间和入库数量.py
     ```

4. **生成分析报表**：

   - 运行

     ```
     输出数据.py
     ```

     生成月度入库分析透视表：

     bash

     ```bash
     python 输出数据.py
     ```

   - 报表将保存到桌面，文件名为`入库数据分析.xlsx`

## 配置说明

主要配置项位置：

- 数据库配置：各脚本中的`DB_CONFIG`字典（包含数据库连接信息）
- Excel 相关配置：
  - 物料信息导入：`入库物料代码和物料描述.py`中的`excel_path`、`sheet_name`、`CODE_COLUMN`、`DESC_COLUMN`
  - 入库数据导入：`入库入库时间和入库数量.py`中的`EXCEL_FILE`、`SHEET_NAME`
- 表名配置：各脚本中的`target_table`、`TABLE_MATERIAL`、`TABLE_STOCK`（数据库表名）

## 文件说明

| 文件名                    | 功能说明                                                     |
| ------------------------- | ------------------------------------------------------------ |
| 入库物料代码和物料描述.py | 从 Excel 导入物料代码和描述到`material_info`表               |
| 入库入库时间和入库数量.py | 从 Excel 导入入库时间和数量到`material_stock`表              |
| 输出数据.py               | 从数据库生成月度入库数据透视表并导出到 Excel                 |
| db_utils.py               | 数据库操作工具类（连接、关闭、表创建、数据插入等）           |
| excel_utils.py            | Excel 操作工具类（文件检查、加载、工作表获取、单元格读取等） |
| utils.py                  | 通用工具函数（桌面路径获取、描述文本清洗等）                 |

## 注意事项

- 导入前请确保 Excel 文件格式正确，表头和数据列位置与配置一致
- 数据库需提前创建（脚本不会自动创建数据库，仅创建表）
- 若出现重复数据导入，`material_info`表会自动更新描述信息，`material_stock`表因主键约束会跳过重复数据
- 透视表包含各物料月度入库量及月度合计行，月份列按时间顺序排列# 物料入库信息管理与分析系统
